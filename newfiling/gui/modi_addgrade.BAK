Local Array laForm[1]
Local loForm1

modi form addgrade Nowait
&& Create Form lcFormPath + [frmMain.scx] As Form Nowait
ASelObj(laForm,1)


&&  Form1
loForm1 = laForm[1]
with loForm1
    .Caption = "补录成绩"
    .SetAll("Aligment", 2, "Label")
endwith

&& 准考证号 Label1
loLabel1 = loForm1.Label1
With loLabel1
    .Caption = "准考证号"
EndWith

&& 身份证号 Label2
loLabel2 = loForm1.Label2
With loLabel2
    .Caption = "身份证号"
EndWith

&& 学生姓名 Label3
loLabel3 = loForm1.Label3
With loLabel3
    .Caption = "学生姓名"
EndWith

&& 高中名称 Label4

&& 成绩表 Grid1
loGrid1 = loPage1.Grid1
with loGrid1
    .RecordSource = "file_info"
    .RecordSourceType = 1

    .Left = 0
    .Top = loForm1.SysInfo.PFGridT()
    .Width = loForm1.SysInfo.PFGridW()
    .Height = loForm1.SysInfo.PFGridH()

    && --------------------- Grid 属性设置 ---------------------
    .AllowCellSelection = .F.
    .AllowHeaderSizing = .F.
    .AllowRowSizing = .F.
    .BackColor = RGB(248, 248, 248)
    .ColumnCount = 13
    .DeleteMark = .F.
    .FontName = "微软雅黑"
    .FontSize = 11
    .GridLineColor = RGB(147, 147, 147)
    .HeaderHeight = 30
    .RowHeight = 27
    .Height = 612
    .HighlightBackColor = RGB(165, 207, 240)
    .HighlightForeColor = RGB(0, 0, 0)
    .HighlightStyle = 2 && 允许高亮并保持高亮可见
    .Panel = 1 && 右
    .ReadOnly = .T.
    .RecordMark = .F.
    .RowHeight = 22
    .ScrollBars = 3 && 既水平又垂直(默认)
    .SplitBar = .F.
    .TabIndex = 1
    .Visible = .T.

    && --------------------- Grid 子属性设置 ---------------------
	.SetAll("Alignment", 2, "Header")
	.SetAll("backColor", RGB(210, 210, 210), "Header")
	.SetAll("FontName", "微软雅黑", "Header")
	.SetAll("FontSize", 11, "Header")

	.SetAll("Alignment", 2, "Column")
	.SetAll("FontName", "微软雅黑", "Column")
	.SetAll("FontSize", 10, "Column")
	.SetAll("Format", "Z", "Column")

    .Columns(1).ControlSource = "file_info.pass_num"
    .Columns(1).Width = 8 * 10
    .Columns(1).Header1.Caption = "准考证号"

    .Columns(2).ControlSource = "file_info.id_card"
    .Columns(2).Width = 8 * 20
    .Columns(2).Header1.Caption = "身份证号"

    .Columns(3).ControlSource = "file_info.stu_name"
    .Columns(3).Width = 8 * 8
    .Columns(3).Header1.Caption = "学生姓名"

    .Columns(4).ControlSource = "file_info.high_name"
    .Columns(4).Width = 8 * 24
    .Columns(4).Header1.Caption = "高中名称"

    .Columns(5).ControlSource = "file_info.all_score"
    .Columns(5).Header1.Caption = "总分"
    .Columns(5).Width = 8 * 6

    .Columns(6).ControlSource = "file_info.chinese"
    .Columns(6).Header1.Caption = "语文"
    .Columns(6).Width = 8 * 6

    .Columns(7).ControlSource = "file_info.math"
    .Columns(7).Header1.Caption = "数学"
    .Columns(7).Width = 8 * 6

    .Columns(8).ControlSource = "file_info.english"
    .Columns(8).Header1.Caption = "英语"
    .Columns(8).Width = 8 * 6

    .Columns(9).ControlSource = "file_info.composite"
    .Columns(9).Header1.Caption = "综合"
    .Columns(9).Width = 8 * 6

    .Columns(10).ControlSource = "file_info.rank"
    .Columns(10).Header1.Caption = "排名"
    .Columns(10).Width = 8 * 6

    .Columns(11).ControlSource = "file_info.volu_name1"
    .Columns(11).Header1.Caption = "第一志愿"
    .Columns(11).Width = 8 * 22

    .Columns(12).ControlSource = "file_info.volu_name2"
    .Columns(12).Header1.Caption = "第二志愿"
    .Columns(12).Width = 8 * 22

    .Columns(13).ControlSource = "file_info.volu_name3"
    .Columns(13).Header1.Caption = "第三志愿"
    .Columns(13).Width = 8 * 22

endwith

&& 跟随设置




do cp2grade