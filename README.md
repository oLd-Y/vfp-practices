This is some practices of Visual FoxPro from jiangyang.

# Practice1

在 D:\建立一个库，结构为：类型 C(4)，品名 C(8)，入库数量 N(8,2)，日期时间 D

## 编写 PRG

- 往库中加 30 条记录，使数据库的记录总数保持为 30。
- 依次填写记录内容：
    - 类型为“蔬菜、果品、肉类、冻品、干货”等五种中的随机一种，
    - 品种随机长度（1-8）随机字符（A-Z），
    - 数量随机（1.01-7005.77），
    - 日期随机（2023 年 5 月 1 日（含）以后 60 天中的随机一天）。
- 以入库数量由高到低为序，列表显示数量 4000 以下（含）的记录的品名和入库数量，
    - 从屏幕的第 2 行第 7 列开始，显示品名和入库数量，两个字段间加一个空格；
    - 每行显示 1 条记录，每显示 3 条记录空 1 行。
      关闭所有打开的数据库
      注：用@...SAY 控制屏幕输出的行列位置

## 做一个 FORM

- 左边为 GRID，
    - 各列依次显示日期时间（格式 YYYY-MM-DD），类型，品名，入库数量，
    - 保持 GRID 的当前行始终可见，
    - 当前行的背景色为 196,128,196，
    - GRID 为只读。
- 在建立一个 TEXT 和 COMMAND 对象，当 GRID 的光条移动后，TEXT 对象为 GRID 当前记录的品名字段内容，可被编辑；
- COMMAND 对象显示的内容为”保存”。当点击“保存”的按钮时:
    - 判断如果 TEXT 的内容为空需要提示给用户重新输入，
    - 否则将 GRID 对应记录的品名替换为 TEXT 的内容，
    - 替换前需要把左边所有的空格剔除，
    - GRID 中显示的相应内容也同步更新。

# Practice2

1. 作为初学者很不错了，表扬

2. 第一题是一体的，做一个PRG，不要拆分成三个；注意运行前的环境为空，无变量无打开的表，执行完毕复原；本题不可以用SQL语句和？命令；没按要求显示；

3. 第二题，GRID的显示和刷新有问题；高亮显示有问题；去空格有问题；仔细审题

4. 修正2、3的问题。另要说明几点，以后不再复述：
    1) 环境设置：DATE为ANSI，MARK为’-‘,DELE状态为ON，CENT状态为ON，HOUR为24，TALK、STATUS、STATBAR、SAFETY均为OFF
    2) 程序执行一遍和执行N遍的结果要保持一样。注：取随机数时要把随机基数设置位一样RAND(0)
    3) 界面要布置得合理、美观，既要适合鼠标操作又要适合键盘操作，字体、大小、位置均要考虑。要把你认为是现阶段最好的成果拿出来。
    4) 不能用Wizards向导生成程序
       5）要寻求最快的运行速度，可以将数量量扩大后试验
       6）题目没有明确的要求，但深度理解后需要设定的属性和方法或功能也要配套的。即要把题目理解成交付给用户操作的状态，调试无语法错和逻辑错
       7）有难题可向二张老师求教

5. 做练习:
   主题：高考模拟投档
   设有确定项：
   1）有一表A，存放中学的代码和校名，字段至少有：中学名称代码C(3)，中学名称C(30)
   。数据200条，请自己编程生成，中学名称取“上海第N中学“，N为相应记录的记录号（保留3位数字字符，不足3位前部充零）
   2）有一表B，存放大学的代码和校名，字段至少有：大学名称代码C(3)，大学名称C(30)，学校类型C(4)，计划录取人数N(4)
   ,数据20条，请手工输入内容，录取人数取值范围800-2000，代码3位数字字符
   3）有一表C，存放学生基本信息和填报志愿信息，字段至少有：准考证号C(8)，姓名C(8)，身份证C(18)，中学名称代码C(3)
   ，第一志愿大学的代码，第二志愿大学的代码，第三志愿大学的代码，8万名学生。数据请自己编程生成，中学名称代码从表A中取；准考证号和身份证号在批量生成时必须进行唯一性校验；三个志愿大学的代码从表B中取，每个学生至少有一个志愿，最多三个志愿，依次填入相应字段，没有为空；
   4）有一表D，存放学生高考成绩，字段至少有：准考证号C(8)，身份证C(18)，语文N(3),数学N(3),外语N(3),综合N(3),总分N(3)
   ；按表C的数据生成，每个学生只能且必须有一条；语、数、外的取值范围为0-150，综合的取值范围为0-210，总分相加；各科成绩的分数需按照下列概率分布情况填充：
   分数段（含） 语文 数学 外语 综合
   201-210 3%
   190-200 6%
   180-189 12%
   170-179 15%
   160-169 13%
   150-159 15%
   140-149 0.3% 0.5% 0.5% 11%
   130-149 1% 3% 1% 8%
   120-129 4% 6% 5% 6%
   110-119 10.7% 15% 19% 4%
   100-109 18% 19% 20% 3%
   90- 99 27% 18% 25% 2%
   80- 89 19% 17% 15% 1%
   70- 79 10% 12% 7.5% 0.5%                          
   60- 69 6% 5% 4% 0.3%
   50- 59 3% 4% 2.5% 0.1%  
   0- 49 1% 0.5% 0.5% 0.1%

第一步的要求：
A. 仔细审题
B. 数据库名和存放路径自定
C. 编写PRG，自动按要求一次性生成表A、C、D的数据，每次执行均要保持要求的记录数不变
D. 在屏幕的第3行第10列开始显示执行该PRG所用去的秒数，显示格式为”NNNNNN.NNN秒"，该字符串保持12位长度
E. 不能使用SQL语句，包括INSERT

# Practice3

补充修正练习二确定项的3）：
如果学生的志愿超过一个，则各自愿不能重复

练习二的第二步要求：
A. 做一个FORM,FORM时的宽度等于屏幕宽度像素，高度为屏幕高度像素-18，该FORM为顶层FORM
B. FORM中建立一个GRID，GRID显示的列依次为准考证号、身份证号、姓名、中学名称、总分、语文、数学、外语、综合、排名位次、第一志愿大学名称、第一志愿大学名称、第一志愿大学名称
C. 可以使用临时库，但关闭FORM时需要将临时库删除
D. GRID中列不能移动，但可调节列宽
E. 姓名列前（含）冻结，不随GRID左右滚条滑动而隐藏
F. 排名位次按照总分由高到底，总分相同则依次按照数学、外语、综合的分值由高到低排名
G. FORM中加一个COMMAND按钮，弹出一个子FORM，叠加在顶层FORM上。子FORM显示成绩分布表，该分布表用GRID显示，列内容为总分、人数、累计人数，子FORM中加一个按钮，功能是将该表导出为EXCEL
H. FORM中各对象的排列、大小、位置、颜色要合理、美观
I. 所有GRID均为READONLY，不显示记录标记和删除标记。当前行为高亮且保持

# Practice4

一、练习1-1

1. FOR和DO WHILE循环内的语句加个TAB，锯齿下方容易阅读差错
2. 进入PRG时CLOSE DATA,执行完毕出去前要复原，也要CLOSE DATA。对于本题虽然结果一样，但要养成良好习惯

二、练习1-2

1. 打开数据库时用全路径表达数据库位置
2. FORM中对象的排列要优化，要给用户好的体验，包括但不限于FORM大小、位置、对象的颜色、大小等等。总之，题目没有特殊要求的部分是需要发挥的，并不是指仅用缺省
3. 所有对象不使用的方法将内容清掉，不然会粗体显示，别人阅读会有影响
4. 输入内容为空时，光标要返回到TEXT对象的头部
5. 保存后，焦点光标要返回到GRID
6. 对象的静态属性（指运行时不改变属性的值）一般不用程序定义
7. REPLACE这句活的替换值为LTRIM(THISFORM.XXXX.VALUE) ，虽然本题GRID的这列被定义了数据源，所以从结果导向没错。
8. FORM关闭时没有复原到进入时的状态，数据库没关闭

三、练习2

1. 速度还可以优化，如在循环内的RECC()和常态变量的赋值可以放在循环外，不要做8万次，不频繁选择区，等等。做数量大的循环时，循环内容一定要极致优化，提速。
2. 当志愿数为3个时，判断条件中，自愿1是否等于自愿2的判断是多余的，仔细想想
3. 循环中用 SET ORDER TO 的用意是什么？取准考证和身份证时，为什么IF条件的.OR.两端是一样的？
4. 索引的排序方式不可以是“PINYIN"

四、练习3

1. 数据库名建议不要用ABCD，题目中只是代号
2. FORM关闭时没有复原到进入时的状态，打开的库、使用的区、当前区、记录指针等）要保存一致
3. FORM大小、GRID的HEADER要居中，字偏小
4. 同二、6
5. 打开FORM时，GRID要定位到排名第1的学生
6.
打开时，速度较慢，算法可以改进吗？同时要给用户以提示，不然他们要认为死机了。
注意人机交互的方式要友好，最好是动态的，让用户看到系统在工作。用户的电脑比你们要慢十倍不止，不能以你的电脑本地独占运行为标准，要以多用户、差电脑、满网络为标准。这点以后不再说明
7. FORM调用另一个FORM的模式不对，没有在顶层表单中，模式不对，照成在点到上层表单是出错
8. 分数段一分一条记录，累计人数是指当前分数以上（含）的累计人数，计算不对
9. GETFILE时的起始位置没有设置，理想状态为D:\，用户定义完后要回到原来的位置。
10. GETFILE后用户没有定义导出文件，就不应该显示"导出成功"

*****
总体还不错，有进步。注意：

1. FORM、DBF、PRG等不要分开目录放，程序类放在一个目录，数据库放在一个目录，在进入VFP调试时，先设置SET DEFA 到程序放的目录，打开数据库用绝对路径
2. 速度、界面是重要的考量指标，标准如四.6
3. 注意细节
4. 导出EXECL后GRID指向的数据库指针被变化了，要复原到按钮点击前的位置。总之，不仅仅是FORM，各个按钮点击干完活后也要复原，特殊功能除外。如果不复原，运行时执行第一次是对的，但不保证第N次或者做了其他功能后再执行这个功能就错了，而且错在哪里是很难找的，任何语言都一样，养成好的习惯。
练习四的表ABCD放在一个本地目录里，模拟是网络目录，本地的临时表放在本地的另一个目录。

*****

除了修正上述问题外，加做练习4：
1. 在练习3的FORM基础上，加一个按钮，弹出1个子FORM： 目的是让操作者（招生办工作人员）选择不同的大学后，显示该大学的被投档学生的信息GRID（内容和次序同练习3的GRID内容）和最低投档线的总分和排位。
2. 投档的规则是： 
   - 最多是该大学计划录取人数的1.3倍 
   - 语数外三科成绩总分不低于280分 
   - 先满足第一志愿是该大学的，人数不足1.3倍时，再依次考虑第二志愿、第三志愿 
   - 如果人数依然不足1.3倍，则结束 
   - 按显示内容打印成报表 
   - 可以方便地按姓名、中学校名和身份证过滤被投档学生信息GRID 
   - 连同练习3的顶层表单和子表单一起建立一个项目，项目图标任意选择，编译成EXE


do form with/to 





